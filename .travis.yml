language: node_js
node_js:
- '8'
- '10'
- '11'
- '12'
- '13'

before_script:
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build

script:
- npm run lint
- npm run build
- npm run test:coverage
- npm run docs

after_script:
  - echo $TRAVIS_TEST_RESULT
  - ./cc-test-reporter after-build --debug --exit-code $TRAVIS_TEST_RESULT

deploy:
  - provider: pages
    skip-cleanup: true
    github-token:
      secure: $PAGES_TOKEN
    keep-history: true
    local-dir: ./docs
    verbose: true
    on:
      branch: master
  - provider: npm
    email: sprokop1010@seznam.cz
    skip_cleanup: true
    api_key:
      secure: MNrefymad++42Cgbr7/3f0NoNKRVYxiizps2hdqICm4tVS9uoMUyRPPSV+F98tSLZXg0uwSxUGvqPr78Mq+7VSwUJdUkZ4hF3TD1o6MlpqyPSIYZYyEwScP3CT9L9VdQLplCT2r+yCuqoy3fPzS4mDH8l1i5rpnLglprmoKIy1nHrEg9NlYSf14Wx6ocfxttndpgyrKBdx+8XsYvmNFKMyXcAvy+NnX2M2vJH8JfNPt66s2KPzJwXPW+pwrfUrPe+ALWchilp4odPCjdx4OgtGAP3yfzbrJBkx/YYAtD3GSSMxwrZUhxlt3RgWW1Vx/e/NnjFDCYTaUmnesbzW4bCE92zawecafITm0cO6tXlbF3YGF6C/h+9KhrUZllYe1l1R6ZRsH1QI4RLRtcoJjBlRn5F2yoojlE/FT/vCT1km2yuXFG1uthaVfMg54gYbnfYyGjlMeMSJHRKnllpXi+QMIUf1qMC0A+pvima3y5lOIDHvRFm5tqctzWghz1S4rEM3AU/V0paxL3QnvHkPTn8YObP5Oit4s8HYeDXtiJ0YcnhnaCyuf77oxAufq2CDdUI/hTXwwEGQrFxcxjf7ifr4/sF6IBx+Dly8tp1gn6Ow8m2ieptSMOg4RHxz+XQW9SkUKS5Gi0ZUQT2F+lLB/e/6TZIBW3Nwpo4lj2jGiX9Vw=
    on:
      tags: true
      repo: stefan-prokop-cz/firebless
